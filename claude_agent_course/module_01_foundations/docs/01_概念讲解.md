# Module 1.1 - 什么是 Agent?

> **学习目标**：通过本文档，你将理解 Agent 的工作原理，以及为什么它对构建智能应用至关重要。

## 为什么需要 Agent？

### 问题场景
在使用 ChatGPT 或 Claude 时，你可能遇到过这样的困境：
- **问题 1**：AI 能告诉你"如何做"，但无法真正帮你"去做"
  - 例如："请帮我整理桌面上的文件" → AI 只能给你建议，无法真正操作你的电脑
- **问题 2**：AI 无法获取实时信息
  - 例如："今天天气如何？" → AI 的知识有截止日期，无法联网查询
- **问题 3**：AI 无法执行复杂的多步骤任务
  - 例如："帮我分析这个 CSV 文件，找出异常数据，并生成报告" → 需要多个步骤协同工作

### 传统解决方案的局限
如果不使用 Agent，我们可能需要：
1. **纯 API 调用** - 只能对话，无法行动
2. **编写大量胶水代码** - 手动处理文件、网络请求、数据转换等
3. **人工介入** - 每一步都需要人工复制粘贴结果

**示例**：纯对话模式的局限
```python
# ❌ 传统方式：AI 只能"说"，不能"做"
from anthropic import Anthropic

client = Anthropic(api_key="...")
response = client.messages.create(
    model="claude-3-5-sonnet-20241022",
    messages=[{"role": "user", "content": "帮我整理 /Downloads 文件夹"}]
)

# AI 只会回复类似这样的文字：
# "您可以按以下步骤整理文件夹：1. 创建子文件夹... 2. 移动文件..."
# 但实际上什么都没发生！
```

---

## 是什么？

### 核心定义
**Agent（智能体）** 是一个能够**自主感知环境、做出决策、并执行操作**的 AI 系统。

简单来说：
- **LLM (Large Language Model)** = 大脑（只会思考和说话）
- **Agent** = 大脑 + 双手 + 眼睛（能思考、能观察、能行动）

### 关键特性
1. **自主性 (Autonomy)**：无需人工干预，自动完成任务
2. **感知能力 (Perception)**：能读取文件、访问网络、查询数据库等
3. **行动能力 (Action)**：能修改文件、执行命令、调用 API 等
4. **推理能力 (Reasoning)**：能规划多步骤任务，处理异常情况

### 类比理解
可以把 **Agent** 想象成一个真正的助手：

| 场景 | 纯 LLM | Agent |
|------|---------|-------|
| 你说："帮我查今天天气" | "抱歉我无法联网" | 自动调用天气 API 并告诉你结果 |
| 你说："整理我的文档" | 给你一个整理方案 | 实际移动和重命名文件 |
| 你说："帮我写周报" | 生成一个模板 | 读取你的工作日志，自动生成周报 |

---

## 如何工作？

### Agent 的核心循环

```
┌─────────────────────────────────────┐
│         Agent 工作循环                │
└─────────────────────────────────────┘
           ↓
    1. Observe (感知)
       - 读取用户输入
       - 查看当前状态
       - 收集环境信息
           ↓
    2. Think (思考)
       - LLM 分析问题
       - 制定行动计划
       - 决定使用哪个工具
           ↓
    3. Act (行动)
       - 执行工具调用
       - 获取执行结果
       - 更新状态
           ↓
    4. Repeat (重复)
       - 如果任务未完成
       - 回到步骤 1
       - 直到目标达成
```

### 详细机制

#### 阶段 1：Observe（感知环境）
- **发生了什么**：Agent 接收用户请求，读取当前环境状态
- **为什么重要**：只有了解现状，才能做出正确决策
- **示例**：用户说"整理文件"，Agent 先查看文件夹里有什么

#### 阶段 2：Think（推理决策）
- **发生了什么**：LLM 分析情况，决定下一步操作
- **为什么重要**：这是 Agent 的"智慧"所在
- **示例**：Agent 思考："有 PDF、图片、文本文件，我应该分类存放"

#### 阶段 3：Act（执行行动）
- **发生了什么**：调用工具（如文件操作 API）执行具体操作
- **为什么重要**：这是 Agent 与环境交互的方式
- **示例**：Agent 创建文件夹，移动文件

### 简单示例
```python
# Agent 的基本工作流程（伪代码）
while not task_completed:
    # 1. Observe（感知）
    current_state = observe_environment()
    user_goal = get_user_request()

    # 2. Think（思考）
    next_action = llm.decide_what_to_do(current_state, user_goal)

    # 3. Act（行动）
    result = execute_tool(next_action)

    # 4. 检查是否完成
    if is_goal_achieved(result):
        task_completed = True
```

---

## LLM vs Agent：本质区别

### 对比表

| 维度 | LLM（如 ChatGPT） | Agent（如 Claude Agent SDK） |
|------|------------------|----------------------------|
| **能力范围** | 只能对话 | 对话 + 行动 |
| **信息获取** | 仅限训练数据 | 可联网、读文件、查数据库 |
| **任务执行** | 给出建议/代码 | 实际执行操作 |
| **交互方式** | 单轮问答 | 多轮推理 + 工具调用 |
| **适用场景** | 创意写作、代码建议 | 自动化任务、数据分析 |

### 实际例子对比

#### 场景：分析日志文件并生成报告

**使用纯 LLM**：
```
你: 帮我分析 server.log，统计错误数量
LLM: 我无法读取文件，请你复制日志内容给我
你: [复制粘贴几千行日志...]
LLM: 根据你提供的日志，有 23 个错误...
你: 好的，帮我生成一个报告
LLM: [生成报告文本]
你: [手动复制到 Word 文档...]
```

**使用 Agent**：
```
你: 帮我分析 server.log，统计错误并生成报告
Agent:
  1. [读取文件] 正在读取 server.log...
  2. [分析数据] 发现 23 个错误，5 个警告
  3. [生成报告] 已创建 error_report.md
  4. 完成！报告已保存到当前目录。
```

---

## 使用场景

### ✅ 适合使用 Agent 的场景

**场景 1：自动化重复性工作**
- 示例：每天早上汇总昨天的代码提交，生成日报
- 为什么适合：Agent 可以自动读取 Git 日志、格式化数据、发送邮件

**场景 2：需要实时信息的任务**
- 示例：监控股票价格，当达到条件时发送通知
- 为什么适合：Agent 可以定时查询 API，做出自动决策

**场景 3：多步骤数据处理**
- 示例：读取 CSV → 数据清洗 → 分析 → 生成图表 → 发送报告
- 为什么适合：Agent 可以串联多个工具，完成端到端流程

**场景 4：文件和代码操作**
- 示例：代码重构助手，自动检测代码问题并提出修改建议
- 为什么适合：Agent 能读写文件，理解代码结构

### ❌ 不适合使用 Agent 的场景

**场景 1：纯创意性工作**
- 示例：写一首诗、设计 logo
- 原因：不需要"行动"能力，纯 LLM 就够了
- 替代方案：直接使用 Claude API

**场景 2：需要人类最终判断的场景**
- 示例：医疗诊断、法律建议
- 原因：风险太高，不应完全自动化
- 替代方案：Agent 提供辅助信息，人类做最终决策

---

## Agent 的类型

### 按自主程度分类

1. **Reactive Agent（反应型）**
   - 特点：接收命令 → 立即执行
   - 示例："帮我创建文件夹"
   - 复杂度：低

2. **Planning Agent（规划型）**
   - 特点：先制定计划 → 逐步执行
   - 示例："帮我重构这个项目"
   - 复杂度：中

3. **Learning Agent（学习型）**
   - 特点：能从历史中学习，优化策略
   - 示例：个性化推荐系统
   - 复杂度：高

### 按工具能力分类

1. **Tool-Calling Agent**（工具调用型）
   - 能力：调用预定义的工具（API、函数）
   - 代表：本课程的重点

2. **Code-Executing Agent**（代码执行型）
   - 能力：自己写代码并执行
   - 代表：ChatGPT Code Interpreter

---

## 深入阅读

### 官方资源
- [Anthropic: Introduction to Agents](https://docs.anthropic.com)
- [Tool Use (Function Calling)](https://docs.anthropic.com/claude/docs/tool-use)

### 学术论文
- [ReAct: Synergizing Reasoning and Acting in Language Models](https://arxiv.org/abs/2210.03629)

### 相关概念
- **ReAct Pattern**：推理 (Reasoning) + 行动 (Acting) 的设计模式
- **Chain of Thought (CoT)**：思维链，让 AI 逐步推理

---

## 关键要点总结

✅ **记住这些**：
1. LLM 只会"说"，Agent 能"做"
2. Agent = 感知 + 思考 + 行动 的循环
3. Agent 的核心是 **Tool Use（工具调用）**
4. 适合自动化、实时性、多步骤的任务

---

## 下一步

✅ 理解了 Agent 的概念后，请继续阅读：
- **[02_代码示例.md](02_代码示例.md)** - 搭建环境，运行第一个 Agent
- **[03_最佳实践.md](03_最佳实践.md)** - 学习如何正确使用

🏗️ **实战项目**：
前往 [projects/project_01_hello_agent](../projects/project_01_hello_agent/) 完成你的第一个 Agent！
